<!DOCTYPE html>
<html lang="en">

<head>
    <title></title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <meta name="robots" content="noodp"/>

    <link rel="stylesheet" href="https://chux0519.github.io/style.css">
    <link rel="stylesheet" href="https://chux0519.github.io/color/hexyoungs.css">

    <link rel="stylesheet" href="https://chux0519.github.io/font-hack-subset.css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="https://chux0519.github.io/rss.xml">


        <link rel="shortcut icon" type="image&#x2F;png" href="/favicon.png">
    
    </head>

<body class="">
<div class="container">
    
    <header class="header">
        <div class="header__inner">
            <div class="header__logo">
                    
                <a href="https://chux0519.github.io" style="text-decoration: none;">
                    <div class="logo">
                            chux0519
                        </div>
                </a>
            </div>
        </div>

        <nav class="menu">
            <ul class="menu__inner">
                <li><a href="https://chux0519.github.io">main</a></li>
            
                <li class="active"><a href="https://chux0519.github.io/blog">blog</a></li>
            
                <li><a href="https://chux0519.github.io/projects">projects</a></li>
            
                <li><a href="https://github.com/chux0519" target="_blank" rel="noopener noreferrer">github</a></li>
            </ul>
        </nav>
    
    </header>
    

    <div class="content">
        
    <div class="post">
        
    <h1 class="post-title"><a href="https://chux0519.github.io/blog/cs144-lab0/">CS144 Lab0 学习笔记</a></h1>
    <div class="post-meta-inline">
        
    <span class="post-date">
            2020-08-23
        </span>

    </div>

    

        
        <div class="post-content">
            <p>CS144 是一门关于计算机网络的斯坦福大学的公开课。课程的实验是动手写一个用户态的 TCP 协议，非常吸引我，于是就入坑了。我会用一个系列来记录自己的学习笔记。</p>
<ul>
<li>
<p>课程链接: https://cs144.github.io/</p>
</li>
<li>
<p>本文讲义: https://cs144.github.io/assignments/lab0.pdf</p>
</li>
<li>
<p>本文相关代码: https://github.com/hexyoungs/tcplab/tree/lab0</p>
</li>
</ul>
<span id="continue-reading"></span><h2 id="zhun-bei-gong-zuo">准备工作</h2>
<p>课程的讲义虽然是公开的，但作业内容的模板代码是私有的，可能是为了防止学生作弊或者代码泄露，因此我们理论上是没有权限接触到课程代码的，但我在 github 上搜索到了另一位同学的仓库，里面的代码是可以配套使用的，在修复了一个小编译错误之后，我把代码上传到了 github，同学们可以从开头的链接处获取到，<strong>仅供学习使用</strong>。</p>
<h2 id="jiang-yi">讲义</h2>
<p>讲义内容可以大致分为实验和任务两个部分，作为开篇，Lab0 的实验和任务是热身向的。</p>
<p>在实验部分，我们利用 telnet、netcat 等工具，进行 HTTP 报文的发送，进行邮件的发送，以及体验 TCP 的监听和接收功能。实验部分是想让我们了解 TCP 协议的可靠性的特点（保证字节流在不可靠的网络中的可靠传输）。</p>
<p>紧接着便是任务部分，第一个任务是利用 sponge 这个课程提供的库，编写一个发送 HTTP GET 请求，然后阅读返回的 TCP 字节流的小程序，叫做 <code>webget</code>。实现比较容易，复杂的部分被 sponge 库做了，我们只需要浏览相关的头文件，了解一些基础接口，便可以在 10 行左右实现功能。</p>
<p>第二个任务是让我们实现一个单线城的，in-memory 的可靠字节流，说人话就是实现一个 Stream 的抽象，可以读、可以写，并且满足保证读写的顺序一致。由于是单线程，并且不考虑并发读写，我们只需要利用 cpp 标准库里面的容器(这里用了 dequeue )保存数据，然后适配所有的接口并且通过测试用例即可。</p>
<h2 id="yao-dian">要点</h2>
<p>Lab0 的要点其实就一点，TCP 是可靠的字节流。</p>
<p>另外，我在做实现时，学习到了下面两点碎片知识。</p>
<p>第一是，string 和 dequeue&lt;uint8_t&gt; 的交互，可以直接使用 string 的构造函数，将 uint8_t 数组转换为 string。</p>
<pre data-lang="cpp" style="background-color:#2b303b;color:#c0c5ce;" class="language-cpp "><code class="language-cpp" data-lang="cpp"><span>std::string </span><span style="color:#8fa1b3;">s</span><span>(</span><span style="color:#bf616a;">data</span><span>, data + </span><span style="color:#bf616a;">len</span><span>);
</span></code></pre>
<p>反过来，想要将 string 放到容器里面，可以直接使用 <code>std::copy</code> 配合容器的 <code>std::back_inserter</code></p>
<pre data-lang="cpp" style="background-color:#2b303b;color:#c0c5ce;" class="language-cpp "><code class="language-cpp" data-lang="cpp"><span>std::</span><span style="color:#8fa1b3;">copy</span><span>(s.</span><span style="color:#bf616a;">begin</span><span>(), s.</span><span style="color:#bf616a;">end</span><span>(), std::</span><span style="color:#bf616a;">back_inserter</span><span>(data));
</span></code></pre>
<p>第二是，POSIX API <code>getaddrinfo</code> 实际上是可以传入 <code>service</code> 字符串来获取标准端口的。这是我第一次这样使用。</p>
<h2 id="jie-yu">结语</h2>
<p>整个 Lab0 难度不高，内容也不多，但可以调动我们的积极性，开始进入学习状态，期待下一个 Lab。</p>
<p>另外，完整实现在 repo 的 lab0-ans 分支供同学们参考。</p>

        </div>

        
    </div>

    </div>

    
    <footer class="footer">
        <div class="footer__inner">
                <div class="copyright copyright--user">&copy; Copyright 2024 by&nbsp<a href="https://chux0519.github.io">chux0519</a>.</div>
            </div>
    </footer>
    

</div>
</body>

</html>
